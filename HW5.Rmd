---
title: "HW5"
author: "Pablo Maldonado"
date: "12/1/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(tidyr)
library(dplyr)
library(broom)
library(purrr)
library(ggplot2)
library(forcats)
library(ggthemes)
library(lubridate)
library(plotly)
```

# Load the data
```{r}

homicides <- read.csv("data/homicide-data.csv")

homicides <- homicides %>%
  unite("city_name", city:state, sep = ", ")
```


# Just show baltimore
```{r}
baltimore <- homicides %>% 
  filter(city_name == "Baltimore, MD")


baltimore %>%
  filter(grepl("GREY", victim_last))
```

# Group by month and year
```{r}
#
baltimore_mutate_date <- baltimore %>%
  mutate(reported_date = ymd(reported_date)) %>%
  mutate(year = year(reported_date)) %>%
  mutate(month = month(reported_date)) %>%
  mutate(day = day(reported_date)) %>%
  group_by(year, month) %>%
  count() 

baltimore_mutate_date <- baltimore_mutate_date %>%
  mutate(date = paste(year, month,"15", sep = "-")) %>%
  mutate(date = ymd(date))


baltimore_mutate_date
```


# separate by cold or warm years
```{r}
baltimore_summary <- baltimore_mutate_date %>%
  mutate(winter = month %in% c(11, 12, 1:4)) %>%
  mutate(summer = month %in% c(5:10))

```